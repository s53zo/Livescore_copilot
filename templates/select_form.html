<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Livescore Pilot</title>
    <style>
        .hidden {
            display: none;
        }
        .disabled-step {
            opacity: 0.5;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <h1>Livescore Pilot</h1>
    <p>Online tool to follow your progress on the Contest Livescores.</p>

    <!-- Step 1: Contest Selection -->
    <div class="step" id="step1">
        <h2>Step 1: Select Contest</h2>
        <div class="form-group">
            <label for="contest">Choose a Contest:</label>
            <select name="contest" id="contest" required onchange="showStep2()">
                <option value="">-- Select Contest --</option>
                {% for contest in contests %}
                <option value="{{ contest.name }}" {% if selected_contest == contest.name %}selected{% endif %}>
                    {{ contest.name }} ({{ contest.count }} QSOs)
                </option>
                {% endfor %}
            </select>
        </div>
    </div>

    <!-- Step 2: Callsign Selection -->
    <div class="step hidden" id="step2">
        <h2>Step 2: Select Callsign</h2>
        <div class="form-group">
            <label for="callsign">Choose a Callsign:</label>
            <select name="callsign" id="callsign" required onchange="showStep2_5()">
                <option value="">-- Select Callsign --</option>
                {% for callsign in callsigns %}
                <option value="{{ callsign.name }}">
                    {{ callsign.name }} ({{ callsign.qso_count }} QSOs)
                </option>
                {% endfor %}
            </select>
        </div>
    </div>

    <!-- Step 2.5: Category Selection -->
    <div class="step hidden" id="step2_5">
        <h2>Step 2.5: Category Selection</h2>
        <div class="form-group">
            <label for="category_scope">Choose Report Scope:</label>
            <select name="category_scope" id="category_scope">
                <option value="all">All Categories</option>
                {% if selected_category %}
                <option value="selected">Selected Callsign's Category Only (Category: {{ selected_category }})</option>
                {% endif %}
            </select>
        </div>
    </div>

    <!-- Step 3: Report Options (Placeholder for future steps) -->
    <div class="step hidden" id="step3">
        <h2>Step 3: Additional Report Options</h2>
        <p>This section can include additional report filters and options.</p>
    </div>

    <script>
        // Show Step 2 when a contest is selected
        function showStep2() {
            const contestDropdown = document.getElementById('contest');
            const step2 = document.getElementById('step2');
            const step2_5 = document.getElementById('step2_5');
            const step3 = document.getElementById('step3');

            // Show Step 2 only if a contest is selected
            if (contestDropdown.value) {
                step2.classList.remove('hidden');
            } else {
                step2.classList.add('hidden');
                step2_5.classList.add('hidden'); // Hide subsequent steps if contest is deselected
                step3.classList.add('hidden');
            }
        }

        // Show Step 2.5 when a callsign is selected
        function showStep2_5() {
            const callsignDropdown = document.getElementById('callsign');
            const step2_5 = document.getElementById('step2_5');
            const step3 = document.getElementById('step3');

            // Show Step 2.5 only if a callsign is selected
            if (callsignDropdown.value) {
                step2_5.classList.remove('hidden');
                step3.classList.remove('hidden'); // Optionally show Step 3 if needed
            } else {
                step2_5.classList.add('hidden');
                step3.classList.add('hidden'); // Hide subsequent steps if callsign is deselected
            }
        }

        // Initialize visibility based on existing selections on page load
        document.addEventListener("DOMContentLoaded", function() {
            showStep2();
            showStep2_5();
        });
    </script>
</body>
</html>
